use ipnet::IpNet;
use iptrie::{DotWriter, IpRTrieSet};

fn main() {

    let prefixes = [
        "45.56.0.0/18|16591",
        "45.56.64.0/20|63949",
        "45.56.112.0/21|63949",
        "45.56.120.0/21|63949",
        "45.56.132.0/22|62874",
        "45.56.138.0/23|8100",
        "45.56.144.0/23|62874",
        "45.56.146.0/24|206092",
        "45.57.0.0/17|2906",
        "45.57.8.0/23|40027",
        "45.57.8.0/24|40027",
        "45.57.9.0/24|40027",
        "45.57.40.0/23|40027",
        "45.57.40.0/24|40027",
        "45.57.41.0/24|40027",
        "45.57.44.0/24|2906",
        "45.57.45.0/24|2906",
        "45.57.56.0/24|2906",
        "45.57.60.0/24|2906",
        "45.57.63.0/24|2906",
        "45.57.68.0/24|2906",
        "45.57.69.0/24|2906",
        "45.57.76.0/23|40027",
        "45.57.77.0/24|40027",
        "45.57.90.0/23|40027",
        "45.57.91.0/24|40027",
        "45.57.128.0/23|55286",
        "2c0f:ffc8::/48|4578",
        "2c0f:ffc8:6000::/48|4578",
        "2c0f:ffc8:6001::/48|4242",
        "2c0f:ffc8:6002::/48|4242",
        "2c0f:ffc8:6002::/48|4242",
        "2c0f:ffc8:6003::/48|4242",
        "2c0f:ffc8:6004::/48|4242",
        "2c0f:ffc8:6005::/48|4242",
        "2c0f:ffc8:6006::/48|4242",
        "2c0f:ffc8:6007::/48|4242",
        "2c0f:ffc8:6008::/48|4242",
        "2c0f:ffc8:6009::/48|4242",
        "2c0f:ffc8:6015::/48|4242",
        "2c0f:ffc8:6011::/48|4242",
        "2c0f:ffc8:6012::/48|4242",
        "2c0f:ffc8:6013::/48|4242",
        "2c0f:ffc8:6006::/48|4224",
        "2c0f:ffc8:6006::3/48|4242",
        "2c0f:fff0::/48|4242",
        "ff02::2/48|4578",
    ];
    let mut trie = IpRTrieSet::new();

    prefixes.iter()
        .for_each(|x| {
            let mut x = x.split('|');
            let p = x.next().unwrap().parse::<IpNet>().unwrap();
            trie.insert(p);
        });

    trie.v4.open_dot_view().expect("can’t open dot view");
    trie.v6.open_dot_view().expect("can’t open dot view");
    let trie = trie.compress();
    trie.v4.open_dot_view().expect("can’t open dot view");
    trie.v6.open_dot_view().expect("can’t open dot view");
}